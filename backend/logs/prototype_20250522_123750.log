2025-05-22 12:37:50,933 - INFO - FastAPI inicializado
2025-05-22 12:37:51,052 - INFO - Firestore inicializado correctamente
2025-05-22 12:37:51,170 - INFO - Modelo YOLOv11 cargado correctamente
2025-05-22 12:37:54,546 - INFO - MobileNetV2 Embedder for Deep Sort initialised
2025-05-22 12:37:54,547 - INFO - - gpu enabled: False
2025-05-22 12:37:54,548 - INFO - - half precision: False
2025-05-22 12:37:54,548 - INFO - - max batch size: 16
2025-05-22 12:37:54,549 - INFO - - expects BGR: True
2025-05-22 12:37:54,674 - INFO - DeepSort Tracker initialised
2025-05-22 12:37:54,675 - INFO - - max age: 30
2025-05-22 12:37:54,686 - INFO - - appearance threshold: 0.2
2025-05-22 12:37:54,687 - INFO - - nms threshold: OFF
2025-05-22 12:37:54,687 - INFO - - max num of appearance features: None
2025-05-22 12:37:54,687 - INFO - - overriding track class : No
2025-05-22 12:37:54,688 - INFO - - today given : No
2025-05-22 12:37:54,689 - INFO - - in-build embedder : Yes
2025-05-22 12:37:54,689 - INFO - - polygon detections : No
2025-05-22 12:37:54,690 - INFO - DeepSort inicializado correctamente
2025-05-22 12:37:57,279 - INFO - Modelo TimeSformer cargado correctamente
2025-05-22 12:37:57,280 - INFO - Usando dispositivo: cpu
2025-05-22 12:39:39,958 - INFO - Cámara USB (Trust Taxon 2K QHD) abierta correctamente
2025-05-22 12:39:39,973 - INFO - Datos recibidos del frontend: {'offer': {'sdp': 'v=0\r\no=- 1716212038818153491 2 IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\na=group:BUNDLE 0\r\na=extmap-allow-mixed\r\na=msid-semantic: WMS\r\nm=video 9 UDP/TLS/RTP/SAVPF 96 97 98 99 100 101 35 36 37 38 103 104 107 108 109 114 115 116 117 118 39 40 41 42 43 44 45 46 47 48 119 120 121 122 123 124 125 49\r\nc=IN IP4 0.0.0.0\r\na=rtcp:9 IN IP4 0.0.0.0\r\na=ice-ufrag:pOMj\r\na=ice-pwd:IFZYKxChIJSMosjmmYRdkwo0\r\na=ice-options:trickle\r\na=fingerprint:sha-256 EB:04:38:23:5D:DA:A9:04:39:57:CC:44:28:7B:07:F1:D8:75:13:02:FE:66:A3:D2:A6:03:FF:75:62:BE:2C:48\r\na=setup:actpass\r\na=mid:0\r\na=extmap:1 urn:ietf:params:rtp-hdrext:toffset\r\na=extmap:2 http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time\r\na=extmap:3 urn:3gpp:video-orientation\r\na=extmap:4 http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01\r\na=extmap:5 http://www.webrtc.org/experiments/rtp-hdrext/playout-delay\r\na=extmap:6 http://www.webrtc.org/experiments/rtp-hdrext/video-content-type\r\na=extmap:7 http://www.webrtc.org/experiments/rtp-hdrext/video-timing\r\na=extmap:8 http://www.webrtc.org/experiments/rtp-hdrext/color-space\r\na=extmap:9 urn:ietf:params:rtp-hdrext:sdes:mid\r\na=extmap:10 urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id\r\na=extmap:11 urn:ietf:params:rtp-hdrext:sdes:repaired-rtp-stream-id\r\na=recvonly\r\na=rtcp-mux\r\na=rtcp-rsize\r\na=rtpmap:96 VP8/90000\r\na=rtcp-fb:96 goog-remb\r\na=rtcp-fb:96 transport-cc\r\na=rtcp-fb:96 ccm fir\r\na=rtcp-fb:96 nack\r\na=rtcp-fb:96 nack pli\r\na=rtpmap:97 rtx/90000\r\na=fmtp:97 apt=96\r\na=rtpmap:98 VP9/90000\r\na=rtcp-fb:98 goog-remb\r\na=rtcp-fb:98 transport-cc\r\na=rtcp-fb:98 ccm fir\r\na=rtcp-fb:98 nack\r\na=rtcp-fb:98 nack pli\r\na=fmtp:98 profile-id=0\r\na=rtpmap:99 rtx/90000\r\na=fmtp:99 apt=98\r\na=rtpmap:100 VP9/90000\r\na=rtcp-fb:100 goog-remb\r\na=rtcp-fb:100 transport-cc\r\na=rtcp-fb:100 ccm fir\r\na=rtcp-fb:100 nack\r\na=rtcp-fb:100 nack pli\r\na=fmtp:100 profile-id=2\r\na=rtpmap:101 rtx/90000\r\na=fmtp:101 apt=100\r\na=rtpmap:35 VP9/90000\r\na=rtcp-fb:35 goog-remb\r\na=rtcp-fb:35 transport-cc\r\na=rtcp-fb:35 ccm fir\r\na=rtcp-fb:35 nack\r\na=rtcp-fb:35 nack pli\r\na=fmtp:35 profile-id=1\r\na=rtpmap:36 rtx/90000\r\na=fmtp:36 apt=35\r\na=rtpmap:37 VP9/90000\r\na=rtcp-fb:37 goog-remb\r\na=rtcp-fb:37 transport-cc\r\na=rtcp-fb:37 ccm fir\r\na=rtcp-fb:37 nack\r\na=rtcp-fb:37 nack pli\r\na=fmtp:37 profile-id=3\r\na=rtpmap:38 rtx/90000\r\na=fmtp:38 apt=37\r\na=rtpmap:103 H264/90000\r\na=rtcp-fb:103 goog-remb\r\na=rtcp-fb:103 transport-cc\r\na=rtcp-fb:103 ccm fir\r\na=rtcp-fb:103 nack\r\na=rtcp-fb:103 nack pli\r\na=fmtp:103 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42001f\r\na=rtpmap:104 rtx/90000\r\na=fmtp:104 apt=103\r\na=rtpmap:107 H264/90000\r\na=rtcp-fb:107 goog-remb\r\na=rtcp-fb:107 transport-cc\r\na=rtcp-fb:107 ccm fir\r\na=rtcp-fb:107 nack\r\na=rtcp-fb:107 nack pli\r\na=fmtp:107 level-asymmetry-allowed=1;packetization-mode=0;profile-level-id=42001f\r\na=rtpmap:108 rtx/90000\r\na=fmtp:108 apt=107\r\na=rtpmap:109 H264/90000\r\na=rtcp-fb:109 goog-remb\r\na=rtcp-fb:109 transport-cc\r\na=rtcp-fb:109 ccm fir\r\na=rtcp-fb:109 nack\r\na=rtcp-fb:109 nack pli\r\na=fmtp:109 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42e01f\r\na=rtpmap:114 rtx/90000\r\na=fmtp:114 apt=109\r\na=rtpmap:115 H264/90000\r\na=rtcp-fb:115 goog-remb\r\na=rtcp-fb:115 transport-cc\r\na=rtcp-fb:115 ccm fir\r\na=rtcp-fb:115 nack\r\na=rtcp-fb:115 nack pli\r\na=fmtp:115 level-asymmetry-allowed=1;packetization-mode=0;profile-level-id=42e01f\r\na=rtpmap:116 rtx/90000\r\na=fmtp:116 apt=115\r\na=rtpmap:117 H264/90000\r\na=rtcp-fb:117 goog-remb\r\na=rtcp-fb:117 transport-cc\r\na=rtcp-fb:117 ccm fir\r\na=rtcp-fb:117 nack\r\na=rtcp-fb:117 nack pli\r\na=fmtp:117 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=4d001f\r\na=rtpmap:118 rtx/90000\r\na=fmtp:118 apt=117\r\na=rtpmap:39 H264/90000\r\na=rtcp-fb:39 goog-remb\r\na=rtcp-fb:39 transport-cc\r\na=rtcp-fb:39 ccm fir\r\na=rtcp-fb:39 nack\r\na=rtcp-fb:39 nack pli\r\na=fmtp:39 level-asymmetry-allowed=1;packetization-mode=0;profile-level-id=4d001f\r\na=rtpmap:40 rtx/90000\r\na=fmtp:40 apt=39\r\na=rtpmap:41 H264/90000\r\na=rtcp-fb:41 goog-remb\r\na=rtcp-fb:41 transport-cc\r\na=rtcp-fb:41 ccm fir\r\na=rtcp-fb:41 nack\r\na=rtcp-fb:41 nack pli\r\na=fmtp:41 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=f4001f\r\na=rtpmap:42 rtx/90000\r\na=fmtp:42 apt=41\r\na=rtpmap:43 H264/90000\r\na=rtcp-fb:43 goog-remb\r\na=rtcp-fb:43 transport-cc\r\na=rtcp-fb:43 ccm fir\r\na=rtcp-fb:43 nack\r\na=rtcp-fb:43 nack pli\r\na=fmtp:43 level-asymmetry-allowed=1;packetization-mode=0;profile-level-id=f4001f\r\na=rtpmap:44 rtx/90000\r\na=fmtp:44 apt=43\r\na=rtpmap:45 AV1/90000\r\na=rtcp-fb:45 goog-remb\r\na=rtcp-fb:45 transport-cc\r\na=rtcp-fb:45 ccm fir\r\na=rtcp-fb:45 nack\r\na=rtcp-fb:45 nack pli\r\na=fmtp:45 level-idx=5;profile=0;tier=0\r\na=rtpmap:46 rtx/90000\r\na=fmtp:46 apt=45\r\na=rtpmap:47 AV1/90000\r\na=rtcp-fb:47 goog-remb\r\na=rtcp-fb:47 transport-cc\r\na=rtcp-fb:47 ccm fir\r\na=rtcp-fb:47 nack\r\na=rtcp-fb:47 nack pli\r\na=fmtp:47 level-idx=5;profile=1;tier=0\r\na=rtpmap:48 rtx/90000\r\na=fmtp:48 apt=47\r\na=rtpmap:119 H264/90000\r\na=rtcp-fb:119 goog-remb\r\na=rtcp-fb:119 transport-cc\r\na=rtcp-fb:119 ccm fir\r\na=rtcp-fb:119 nack\r\na=rtcp-fb:119 nack pli\r\na=fmtp:119 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=64001f\r\na=rtpmap:120 rtx/90000\r\na=fmtp:120 apt=119\r\na=rtpmap:121 H264/90000\r\na=rtcp-fb:121 goog-remb\r\na=rtcp-fb:121 transport-cc\r\na=rtcp-fb:121 ccm fir\r\na=rtcp-fb:121 nack\r\na=rtcp-fb:121 nack pli\r\na=fmtp:121 level-asymmetry-allowed=1;packetization-mode=0;profile-level-id=64001f\r\na=rtpmap:122 rtx/90000\r\na=fmtp:122 apt=121\r\na=rtpmap:123 red/90000\r\na=rtpmap:124 rtx/90000\r\na=fmtp:124 apt=123\r\na=rtpmap:125 ulpfec/90000\r\na=rtpmap:49 flexfec-03/90000\r\na=rtcp-fb:49 goog-remb\r\na=rtcp-fb:49 transport-cc\r\na=fmtp:49 repair-window=10000000\r\n', 'type': 'offer'}}
2025-05-22 12:39:39,991 - INFO - Connection(0) Could not bind to 169.254.211.92 - [WinError 10049] La dirección solicitada no es válida en este contexto
2025-05-22 12:39:39,991 - INFO - Connection(0) Could not bind to 169.254.187.95 - [WinError 10049] La dirección solicitada no es válida en este contexto
2025-05-22 12:39:45,004 - INFO - Datos recibidos del frontend: {'candidate': {'candidate': 'candidate:2426601672 1 udp 2113937151 b90d65b8-df5b-46c5-a358-b36f6047e821.local 54194 typ host generation 0 ufrag pOMj network-cost 999', 'sdpMid': '0', 'sdpMLineIndex': 0, 'usernameFragment': 'pOMj'}}
2025-05-22 12:39:45,005 - ERROR - Error al procesar candidato ICE: RTCIceCandidate.__init__() got an unexpected keyword argument 'sdp'
2025-05-22 12:39:45,006 - INFO - Datos recibidos del frontend: {'candidate': {'candidate': 'candidate:4036719036 1 udp 2113939711 e60ae13b-d435-4b8a-a118-3a0a24f67b7f.local 54195 typ host generation 0 ufrag pOMj network-cost 999', 'sdpMid': '0', 'sdpMLineIndex': 0, 'usernameFragment': 'pOMj'}}
2025-05-22 12:39:45,007 - ERROR - Error al procesar candidato ICE: RTCIceCandidate.__init__() got an unexpected keyword argument 'sdp'
2025-05-22 12:39:45,007 - INFO - Datos recibidos del frontend: {'candidate': {'candidate': 'candidate:2646056277 1 udp 1677732095 2800:cd0:c332:9400:8143:7f02:c8a7:a456 54195 typ srflx raddr :: rport 0 generation 0 ufrag pOMj network-cost 999', 'sdpMid': '0', 'sdpMLineIndex': 0, 'usernameFragment': 'pOMj'}}
2025-05-22 12:39:45,008 - ERROR - Error al procesar candidato ICE: RTCIceCandidate.__init__() got an unexpected keyword argument 'sdp'
2025-05-22 12:39:45,009 - INFO - Datos recibidos del frontend: {'candidate': {'candidate': 'candidate:4020593062 1 udp 1677729535 181.115.171.180 38675 typ srflx raddr 0.0.0.0 rport 0 generation 0 ufrag pOMj network-cost 999', 'sdpMid': '0', 'sdpMLineIndex': 0, 'usernameFragment': 'pOMj'}}
2025-05-22 12:39:45,009 - ERROR - Error al procesar candidato ICE: RTCIceCandidate.__init__() got an unexpected keyword argument 'sdp'
2025-05-22 12:39:45,011 - INFO - Estado de conexión WebRTC: connecting
2025-05-22 12:39:45,013 - INFO - Connection(0) Discovered peer reflexive candidate Candidate(NZOEtQY2dH 1 udp 1845504255 2800:cd0:c332:9400:be0e:6f0b:23ee:7cc3 54195 typ prflx)
2025-05-22 12:39:45,015 - INFO - Connection(0) Check CandidatePair(('2800:cd0:c332:9400:be0e:6f0b:23ee:7cc3', 61425) -> ('2800:cd0:c332:9400:be0e:6f0b:23ee:7cc3', 54195)) State.WAITING -> State.IN_PROGRESS
2025-05-22 12:39:45,018 - INFO - Connection(0) Check CandidatePair(('2800:cd0:c332:9400:be0e:6f0b:23ee:7cc3', 61425) -> ('2800:cd0:c332:9400:be0e:6f0b:23ee:7cc3', 54195)) State.IN_PROGRESS -> State.SUCCEEDED
2025-05-22 12:39:45,018 - INFO - Connection(0) ICE completed
2025-05-22 12:39:45,045 - INFO - Estado de conexión WebRTC: connected
2025-05-22 12:39:45,643 - INFO - Connection(0) Discovered peer reflexive candidate Candidate(NtCJdsItZ9 1 udp 1845501695 192.168.56.1 54194 typ prflx)
2025-05-22 12:39:45,644 - INFO - Connection(0) Discovered peer reflexive candidate Candidate(aX402fPKj5 1 udp 1845501695 172.23.112.1 54194 typ prflx)
2025-05-22 12:39:45,645 - INFO - Connection(0) Check CandidatePair(('192.168.56.1', 61424) -> ('192.168.56.1', 54194)) State.WAITING -> State.FAILED
2025-05-22 12:39:45,645 - INFO - Connection(0) Check CandidatePair(('172.23.112.1', 61428) -> ('172.23.112.1', 54194)) State.WAITING -> State.FAILED
2025-05-22 12:39:45,646 - INFO - Connection(0) Discovered peer reflexive candidate Candidate(PUuXvjTmkN 1 udp 1845501695 192.168.1.6 54194 typ prflx)
2025-05-22 12:39:45,646 - INFO - Connection(0) Discovered peer reflexive candidate Candidate(JOXtyzqWO1 1 udp 1845504255 2800:cd0:c332:9400:8143:7f02:c8a7:a456 54195 typ prflx)
2025-05-22 12:39:45,647 - INFO - Connection(0) Check CandidatePair(('192.168.56.1', 61424) -> ('192.168.56.1', 54194)) State.FAILED -> State.IN_PROGRESS
2025-05-22 12:39:45,655 - INFO - Connection(0) Check CandidatePair(('172.23.112.1', 61428) -> ('172.23.112.1', 54194)) State.FAILED -> State.IN_PROGRESS
2025-05-22 12:39:45,656 - INFO - Connection(0) Check CandidatePair(('192.168.1.6', 61427) -> ('192.168.1.6', 54194)) State.WAITING -> State.IN_PROGRESS
2025-05-22 12:39:45,656 - INFO - Connection(0) Check CandidatePair(('2800:cd0:c332:9400:8143:7f02:c8a7:a456', 61426) -> ('2800:cd0:c332:9400:8143:7f02:c8a7:a456', 54195)) State.WAITING -> State.IN_PROGRESS
2025-05-22 12:39:45,658 - INFO - Connection(0) Check CandidatePair(('192.168.56.1', 61424) -> ('192.168.56.1', 54194)) State.IN_PROGRESS -> State.SUCCEEDED
2025-05-22 12:39:45,659 - INFO - Connection(0) Check CandidatePair(('172.23.112.1', 61428) -> ('172.23.112.1', 54194)) State.IN_PROGRESS -> State.SUCCEEDED
2025-05-22 12:39:45,659 - INFO - Connection(0) Check CandidatePair(('192.168.1.6', 61427) -> ('192.168.1.6', 54194)) State.IN_PROGRESS -> State.SUCCEEDED
2025-05-22 12:39:45,659 - INFO - Connection(0) Check CandidatePair(('2800:cd0:c332:9400:8143:7f02:c8a7:a456', 61426) -> ('2800:cd0:c332:9400:8143:7f02:c8a7:a456', 54195)) State.IN_PROGRESS -> State.SUCCEEDED
2025-05-22 12:40:14,456 - INFO - Datos recibidos del frontend: {'start_detection': True}
2025-05-22 12:40:14,457 - INFO - Detección iniciada
2025-05-22 12:41:21,990 - INFO - Estado de conexión WebRTC: closed
2025-05-22 12:41:21,996 - INFO - Cliente desconectado
